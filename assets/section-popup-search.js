"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _wrapNativeSuper(e){var r="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function _construct(e,t,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);t=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(t,r.prototype),t}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty(e,t,r){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}!function n(o,i,u){function c(t,e){if(!i[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(s)return s(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=i[t]={exports:{}},o[t][0].call(r.exports,function(e){return c(o[t][1][e]||e)},r,r.exports,n,o,i,u)}return i[t].exports}for(var s="function"==typeof require&&require,e=0;e<u.length;e++)c(u[e]);return c}({1:[function(e,t,r){customElements.get("popup-search")||customElements.define("popup-search",function(){_inherits(r,_wrapNativeSuper(HTMLElement));var t=_createSuper(r);function r(){var e;return _classCallCheck(this,r),_defineProperty(_assertThisInitialized(e=t.call(this)),"searchInput",e.querySelector(".popup-search__input")),e}return _createClass(r,[{key:"connectedCallback",value:function(){var e=this;PubSub.subscribe("open-search",this.openSearch.bind(this)),this.querySelector(".icon-close").addEventListener("click",this.closeSearch.bind(this)),this.searchInput.addEventListener("input",function(){return e.setValue(e.searchInput.value)}),this.querySelector(".popup-search__btn").addEventListener("click",function(){return e.search()})}},{key:"openSearch",value:function(){this.classList.add("active")}},{key:"closeSearch",value:function(){this.classList.remove("active")}},{key:"setValue",value:function(e){this.querySelector(".form-hidden-input").value=e}},{key:"search",value:function(){var t=this,e=this.querySelector(".popup-search__form-hidden"),r=window.theme.shopUrl+window.theme.routes.search_page,e={method:"POST",body:new FormData(e)};fetch(r,e).then(function(e){if(e.ok)return e.text()}).then(function(e){e=(new DOMParser).parseFromString(e,"text/html");t.querySelector(".popup-search__results").innerHTML=e.querySelector(".search-main__results").innerHTML})}},{key:"predictive_search",value:function(e){fetch(window.Shopify.routes.root+"search/suggest.json?q=".concat(e,"&resources[type]=pages&resources[options][fields]=title,author")).then(function(e){return e.json()}).then(function(e){e=e.resources.results.products;console.log(e),0<e.length&&e[0]})}}]),r}())},{}]},{},[1]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvc2VjdGlvbi1wb3B1cC1zZWFyY2guanMiLCJzZWN0aW9uLXBvcHVwLXNlYXJjaC5qcyJdLCJuYW1lcyI6WyJyIiwiZSIsIm4iLCJ0IiwibyIsImkiLCJmIiwiYyIsInJlcXVpcmUiLCJ1IiwiYSIsIkVycm9yIiwiY29kZSIsInAiLCJleHBvcnRzIiwiY2FsbCIsImxlbmd0aCIsIjEiLCJtb2R1bGUiLCJjdXN0b21FbGVtZW50cyIsImdldCIsImRlZmluZSIsIl9pbmhlcml0cyIsIkNhcnRNYWluIiwiX3dyYXBOYXRpdmVTdXBlciIsIkhUTUxFbGVtZW50IiwiX3N1cGVyIiwiX2NyZWF0ZVN1cGVyIiwiX3RoaXMiLCJfY2xhc3NDYWxsQ2hlY2siLCJ0aGlzIiwiX2RlZmluZVByb3BlcnR5IiwiX2Fzc2VydFRoaXNJbml0aWFsaXplZCIsInF1ZXJ5U2VsZWN0b3IiLCJfY3JlYXRlQ2xhc3MiLCJrZXkiLCJ2YWx1ZSIsIl90aGlzMiIsIlB1YlN1YiIsInN1YnNjcmliZSIsIm9wZW5TZWFyY2giLCJiaW5kIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsb3NlU2VhcmNoIiwic2VhcmNoSW5wdXQiLCJzZXRWYWx1ZSIsInNlYXJjaCIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsIl90aGlzMyIsImZvcm0iLCJmb3JtVXJsIiwid2luZG93IiwidGhlbWUiLCJzaG9wVXJsIiwicm91dGVzIiwic2VhcmNoX3BhZ2UiLCJmb3JtQm9keSIsIm1ldGhvZCIsImJvZHkiLCJGb3JtRGF0YSIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwidGV4dCIsImRhdGEiLCJodG1sIiwiRE9NUGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwiaW5uZXJIVE1MIiwiU2hvcGlmeSIsInJvb3QiLCJjb25jYXQiLCJyZXNwb25zZSIsImpzb24iLCJzdWdnZXN0aW9ucyIsInByb2R1Y3RTdWdnZXN0aW9ucyIsInJl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QUFBRSxLQUFBLENBRUEsQ0FBQSxFQUNBSCxLQUFBLFNBQUFJLEdBQ0FDLEdBQUEsSUFBQUMsV0FBQUMsZ0JBQUFILEVBQUEsV0FBQSxFQUNBakIsRUFBQWpCLGNBQUEsd0JBQUEsRUFBQXNDLFVBQUFILEVBQUFuQyxjQUFBLHVCQUFBLEVBQUFzQyxTQUNBLENBQUEsQ0FDQSxDQUFBLEVBQUEsQ0FBQXBDLElBQUEsb0JBQUFDLE1BRUEsU0FBQUEsR0FDQTBCLE1BQUFULE9BQUFtQixRQUFBaEIsT0FBQWlCLEtBQUEseUJBQUFDLE9BQUF0QyxFQUFBLGdFQUFBLENBQUEsRUFDQTJCLEtBQUEsU0FBQVksR0FBQSxPQUFBQSxFQUFBQyxLQUFBLENBQUEsQ0FBQSxFQUNBYixLQUFBLFNBQUFjLEdBQ0FDLEVBQUFELEVBQUFFLFVBQUFDLFFBQUFDLFNBQ0FDLFFBQUFDLElBQUFMLENBQUEsRUFDQSxFQUFBQSxFQUFBOUQsUUFDQThELEVBQUEsRUFHQSxDQUNBLENBRUEsQ0FBQSxFQUFBLEVBQUF2RCxDQUFBLEVBekRBLENBMkRBLENDR0EsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDLEVEckRYIiwiZmlsZSI6InNlY3Rpb24tcG9wdXAtc2VhcmNoLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsImlmICghY3VzdG9tRWxlbWVudHMuZ2V0KCdwb3B1cC1zZWFyY2gnKSkge1xyXG4gIGN1c3RvbUVsZW1lbnRzLmRlZmluZSgncG9wdXAtc2VhcmNoJywgY2xhc3MgQ2FydE1haW4gZXh0ZW5kcyBIVE1MRWxlbWVudCB7XHJcbiAgICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHNlYXJjaElucHV0ID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcucG9wdXAtc2VhcmNoX19pbnB1dCcpXHJcbiAgICAgIGNvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ29wZW4tc2VhcmNoJywgdGhpcy5vcGVuU2VhcmNoLmJpbmQodGhpcykpXHJcbiAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCcuaWNvbi1jbG9zZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZVNlYXJjaC5iaW5kKHRoaXMpKVxyXG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB0aGlzLnNldFZhbHVlKHRoaXMuc2VhcmNoSW5wdXQudmFsdWUpKVxyXG4gICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLnBvcHVwLXNlYXJjaF9fYnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLnNlYXJjaCgpKVxyXG4gICAgICB9XHJcblxyXG4gICAgICBvcGVuU2VhcmNoKCl7XHJcbiAgICAgICAgdGhpcy5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKVxyXG4gICAgICB9XHJcblxyXG4gICAgICBjbG9zZVNlYXJjaCgpe1xyXG4gICAgICAgIHRoaXMuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJylcclxuICAgICAgfVxyXG5cclxuICAgICAgc2V0VmFsdWUodmFsdWUpe1xyXG4gICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCcuZm9ybS1oaWRkZW4taW5wdXQnKS52YWx1ZSA9IHZhbHVlXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHNlYXJjaCgpe1xyXG4gICAgICAgIGNvbnN0IGZvcm0gPSB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC1zZWFyY2hfX2Zvcm0taGlkZGVuJylcclxuICAgICAgICBjb25zdCBmb3JtVXJsID0gd2luZG93LnRoZW1lLnNob3BVcmwgKyB3aW5kb3cudGhlbWUucm91dGVzLnNlYXJjaF9wYWdlXHJcbiAgICAgICAgY29uc3QgZm9ybUJvZHkgPSB7XHJcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcclxuICAgICAgICAgIGJvZHk6IG5ldyBGb3JtRGF0YShmb3JtKVxyXG4gICAgICAgIH1cclxuICAgICAgICBmZXRjaChmb3JtVXJsLCBmb3JtQm9keSlcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy50ZXh0KClcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaHRtbCA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoZGF0YSwgXCJ0ZXh0L2h0bWxcIik7XHJcbiAgICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLnBvcHVwLXNlYXJjaF9fcmVzdWx0cycpLmlubmVySFRNTCA9IGh0bWwucXVlcnlTZWxlY3RvcignLnNlYXJjaC1tYWluX19yZXN1bHRzJykuaW5uZXJIVE1MXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgIHByZWRpY3RpdmVfc2VhcmNoKHZhbHVlKSB7XHJcbiAgICAgIGZldGNoKHdpbmRvdy5TaG9waWZ5LnJvdXRlcy5yb290ICsgYHNlYXJjaC9zdWdnZXN0Lmpzb24/cT0ke3ZhbHVlfSZyZXNvdXJjZXNbdHlwZV09cGFnZXMmcmVzb3VyY2VzW29wdGlvbnNdW2ZpZWxkc109dGl0bGUsYXV0aG9yYClcclxuICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHJlc3BvbnNlLmpzb24oKSlcclxuICAgICAgICAudGhlbigoc3VnZ2VzdGlvbnMpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcHJvZHVjdFN1Z2dlc3Rpb25zID0gc3VnZ2VzdGlvbnMucmVzb3VyY2VzLnJlc3VsdHMucHJvZHVjdHM7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhwcm9kdWN0U3VnZ2VzdGlvbnMpXHJcbiAgICAgICAgICAgIGlmIChwcm9kdWN0U3VnZ2VzdGlvbnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGZpcnN0UHJvZHVjdFN1Z2dlc3Rpb24gPSBwcm9kdWN0U3VnZ2VzdGlvbnNbMF07XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgKTtcclxuXHJcbiAgICB9XHJcbiAgICB9XHJcbiAgKVxyXG59IiwiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSh7MTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5pZiAoIWN1c3RvbUVsZW1lbnRzLmdldCgncG9wdXAtc2VhcmNoJykpIHtcclxuICBjdXN0b21FbGVtZW50cy5kZWZpbmUoJ3BvcHVwLXNlYXJjaCcsIGNsYXNzIENhcnRNYWluIGV4dGVuZHMgSFRNTEVsZW1lbnQge1xyXG4gICAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBzZWFyY2hJbnB1dCA9IHRoaXMucXVlcnlTZWxlY3RvcignLnBvcHVwLXNlYXJjaF9faW5wdXQnKVxyXG4gICAgICBjb25uZWN0ZWRDYWxsYmFjaygpIHtcclxuICAgICAgICBQdWJTdWIuc3Vic2NyaWJlKCdvcGVuLXNlYXJjaCcsIHRoaXMub3BlblNlYXJjaC5iaW5kKHRoaXMpKVxyXG4gICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLmljb24tY2xvc2UnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xvc2VTZWFyY2guYmluZCh0aGlzKSlcclxuICAgICAgICB0aGlzLnNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gdGhpcy5zZXRWYWx1ZSh0aGlzLnNlYXJjaElucHV0LnZhbHVlKSlcclxuICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC1zZWFyY2hfX2J0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5zZWFyY2goKSlcclxuICAgICAgfVxyXG5cclxuICAgICAgb3BlblNlYXJjaCgpe1xyXG4gICAgICAgIHRoaXMuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJylcclxuICAgICAgfVxyXG5cclxuICAgICAgY2xvc2VTZWFyY2goKXtcclxuICAgICAgICB0aGlzLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHNldFZhbHVlKHZhbHVlKXtcclxuICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcignLmZvcm0taGlkZGVuLWlucHV0JykudmFsdWUgPSB2YWx1ZVxyXG4gICAgICB9XHJcblxyXG4gICAgICBzZWFyY2goKXtcclxuICAgICAgICBjb25zdCBmb3JtID0gdGhpcy5xdWVyeVNlbGVjdG9yKCcucG9wdXAtc2VhcmNoX19mb3JtLWhpZGRlbicpXHJcbiAgICAgICAgY29uc3QgZm9ybVVybCA9IHdpbmRvdy50aGVtZS5zaG9wVXJsICsgd2luZG93LnRoZW1lLnJvdXRlcy5zZWFyY2hfcGFnZVxyXG4gICAgICAgIGNvbnN0IGZvcm1Cb2R5ID0ge1xyXG4gICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXHJcbiAgICAgICAgICBib2R5OiBuZXcgRm9ybURhdGEoZm9ybSlcclxuICAgICAgICB9XHJcbiAgICAgICAgZmV0Y2goZm9ybVVybCwgZm9ybUJvZHkpXHJcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMudGV4dCgpXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgICAgICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGh0bWwgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGRhdGEsIFwidGV4dC9odG1sXCIpO1xyXG4gICAgICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC1zZWFyY2hfX3Jlc3VsdHMnKS5pbm5lckhUTUwgPSBodG1sLnF1ZXJ5U2VsZWN0b3IoJy5zZWFyY2gtbWFpbl9fcmVzdWx0cycpLmlubmVySFRNTFxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICBwcmVkaWN0aXZlX3NlYXJjaCh2YWx1ZSkge1xyXG4gICAgICBmZXRjaCh3aW5kb3cuU2hvcGlmeS5yb3V0ZXMucm9vdCArIGBzZWFyY2gvc3VnZ2VzdC5qc29uP3E9JHt2YWx1ZX0mcmVzb3VyY2VzW3R5cGVdPXBhZ2VzJnJlc291cmNlc1tvcHRpb25zXVtmaWVsZHNdPXRpdGxlLGF1dGhvcmApXHJcbiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgICAgLnRoZW4oKHN1Z2dlc3Rpb25zKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb2R1Y3RTdWdnZXN0aW9ucyA9IHN1Z2dlc3Rpb25zLnJlc291cmNlcy5yZXN1bHRzLnByb2R1Y3RzO1xyXG4gICAgICAgICAgY29uc29sZS5sb2cocHJvZHVjdFN1Z2dlc3Rpb25zKVxyXG4gICAgICAgICAgICBpZiAocHJvZHVjdFN1Z2dlc3Rpb25zLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICBjb25zdCBmaXJzdFByb2R1Y3RTdWdnZXN0aW9uID0gcHJvZHVjdFN1Z2dlc3Rpb25zWzBdO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgfVxyXG4gICAgfVxyXG4gIClcclxufVxufSx7fV19LHt9LFsxXSlcblxuIl19
